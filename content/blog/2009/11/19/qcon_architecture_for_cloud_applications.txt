[%- META
      menu_choice = 'blog'
      page_title  = 'QCon 2009: Software Architecture for Cloud Applications' -%]

<h1>QCon 2009: Software Architecture for Cloud Applications</h1>

<p><strong>Michael Nygard</strong></p>

<p>Cloud: any rapidly-provisioned, on-demand computing or
application services. </p>

<p>Grid: large-scale computing services, typically hiterogeneous,
distributed, and parallel.</p>

<p>Utility: "pay for what you use"</p>

<p>IaaS/PaaS/SaaS -- even though names are similar, they're not</p>

<p>Most of this talk will be discussing Cloud + IaaS</p>

<p>Recent on-demand models:</p>

<ul>
<li>LHC, due to the amount of data generated by every collision</li>
<li>Utility computing: just a billing method; variable demand;
ceiling usually capped
<ul>
<li>Good for holiday volumes: to handle 2 months of the year
they're overspending the other 10</li>
</ul></li>
</ul>

<p>Trends leading to clouds:</p>

<ul>
<li>Virtualization</li>
<li>Commoditization</li>
<li>Horizontally scalable architecture</li>
<li>Rapid provisioning</li>
</ul>

<p>Virtualization:</p>

<ul>
<li>Be able to factor out devices and drivers</li>
<li>Applications can be as messy as they like (ISOLATION)</li>
<li>Take advantage of idle processing</li>
</ul>

<p>Commoditization:</p>

<ul>
<li>43 Dell M600 for cost of 1 HP 7410</li>
<li>Nothing in the former is hot-swappable, and it WILL break</li>
<li>...but you'll need to be able to fire up a new server
really quickly</li>
</ul>

<p>How is virtualization + cloud different? Related to who does what
(admin or user), how quick + automatic provisioning is (if it's
under programmatic control).</p>

<p>Cloud: specialized hardware is abstracted away -- load balancers,
firewalls, SANs, etc. These get turned into declarative aspects
rather than actual boxes. ("Environment: I need to allow a
network connection from X to Y, and I need X GB of storage...")</p>

<p>Choosing a provider:</p>

<ul>
<li>like corn farming: small margin, large fixed costs, scale
essential </li>
<li>small providers won't be around long</li>
</ul>

<p>Cloud near you ("private cloud" or a "fog"); some people don't
call this a cloud, but since it fits a number of the
characteristics above MN does.</p>

<p>Easiest way to get ready for cloud: do nothing! It'll work, but
you'll miss out on some items.</p>

<ul>
<li>Advantages.
<ul>
<li>Scalability</li>
<li>Bundling: be able to paper over operational failures</li>
<li>Ephemerality</li>
</ul></li>
<li>Risks:
<ul>
<li>Availability: there are more moving pieces, which means
risk to availability</li>
<li>Geography</li>
<li>Ephemerality</li>
</ul></li>
</ul>

<p>EC2 quirks:</p>

<ul>
<li>"clean boot" is REALLY clean</li>
<li>local storaage not persistent</li>
<li>IP address not predictable</li>
</ul>

<p>Controlling the flock of EC2s: talking via an API to your
instances. You can talk via SSH or rdesktop to a single one
also. </p>

<p>Bundling: start with an amz image (?); do stuff (install,
configure), then you store it as S3 resource.</p>

<ul>
<li>Can automate this and have your build server churning out
fully bootable images.</li>
<li>~half of all failures come within 24 hours of change; this
is because of bad change control, lack of automation</li>
<li>Plus side of ephemerality -- can fire up instance for user
acceptance testing, then once it's good it's just a matter of
assigning IPs. Once that's working for a while, you can just
blow away the old machines.
<ul>
<li>This is like trucking in a bunch of machines with every
upgrade.</li>
</ul></li>
</ul>

<p>Handling concurrent versions:</p>

<ul>
<li>web assets: old version in URLs</li>
<li>integration points: version all protocols and encodings;
client has to specify which one it's using</li>
<li>DB: migration automated; split into phases; expand first,
contract later ("refactoring databases" has info on this)</li>
</ul>

<p>Scalability: master/worker pattern</p>

<ul>
<li>Workers pulling work off queue; master watching the workers and
time to complete jobs; will fire up new EC2 instances if the
work is taking too long(github recently talked about this)</li>
<li>NYTimes: converting 11 million articles, firing up several
hundred servers for a weekend</li>
<li>animoto.com: were able to go from 50 to 5000 processing
nodes in 1 week when they got popular (facebook, etc)</li>
</ul>

<p>Map/reduce, hadoop; many workers in parallel; resilience thru
re-execution; move computation to data. Amazon has 'Elastic
Map/Reduce' which hides you from network topology requirements.</p>

<p>Scalability: horizontal replication -- make read-only snapshots
of database, let them serve up data that changes very rarely.</p>

<ul>
<li><p>Now have the ability to use declarative load balancing,
automatic scaling. Every load balancer out there requires you
to configure the workers in the pool, and when configuring must
restart. This is a problem when new nodes can pop up
automatically. Specify some tolerance of use, and if you go
outside it we add another node; this gets put into the auto
load-balanced group. (Takes about 5 minutes to react, "So if
Oprah mentions you on twitter you're still dead.")</p></li>
<li><p>Natural affinity between cloud computing and open source.</p></li>
<li>Cache servers and in-memory data grids
<ul>
<li>essential components; translate things you like to do least
in the cloud and turn them into the things you like to do
most.</li>
</ul></li>
</ul>

<p>Mitigating the downside of ephemerality: anything can disappear
at any moment.</p>

<ul>
<li>Failure of block storage: snapshot data to S3, so a parallel
system can be setup and read from the snapshot.</li>
</ul>

<p>Another pattern:</p>

<ul>
<li>Decentralized adoption of cloud computing (he's paying for EC2
instances with secretary's credit card)</li>
</ul>

<p>Security:</p>

<ul>
<li><em>Perception</em> of risk is just that, stem from idea that security
is either perfect or worthless. Security profs don't think
this way, more about risk data. WIBHI reaction ("Wouldn't it
be horrible if...")</li>
<li>Cloud security alliance working on this</li>
<li>Control plane threats (set of APIs who determine who can access
what) any managed hosting provider has this issue</li>
<li>Patent shutdowns: be sure you have strategies for extracting
yourself (VM + data) from your provider</li>
<li>Lack of risk management info</li>
</ul>

<p>Facilities to apply</p>

<ul>
<li>Data in motion: transport level encryption</li>
<li>Data at rest: storage level encryption</li>
<li>Access control: security groups (~VLANs and firewalls)</li>
<li>Control plane: not under your control</li>
<li>Multitenancy concerns: not under your control</li>
</ul>

<!-- Tags: qcon; conference; cloudcomputing; architecture; design  -->

<!--#include virtual="/includes/thread.html" -->
